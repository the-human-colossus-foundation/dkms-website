<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Infrastructure | Decentralised Key Management System</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-D4wt08oL.css" as="style"><link rel="stylesheet" href="/assets/style-D4wt08oL.css">
    <link rel="modulepreload" href="/assets/app-1xjWvnao.js"><link rel="modulepreload" href="/assets/infrastructure.html-0GXNgkfu.js">
    <link rel="prefetch" href="/assets/index.html-BmW0x01q.js" as="script"><link rel="prefetch" href="/assets/introduction.html-DNA4UG2g.js" as="script"><link rel="prefetch" href="/assets/client.html-CYr4kef0.js" as="script"><link rel="prefetch" href="/assets/architecture.html-D8gm0Eh1.js" as="script"><link rel="prefetch" href="/assets/concepts.html-DSutdwmW.js" as="script"><link rel="prefetch" href="/assets/glossary.html-CRHerZME.js" as="script"><link rel="prefetch" href="/assets/why.html-B0QxC1bc.js" as="script"><link rel="prefetch" href="/assets/404.html-BIjQngYx.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/logo.png" alt="Decentralised Key Management System"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Decentralised Key Management System</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/introduction/why.html" aria-label="DKMS Concepts"><!--[--><!--[--><!--]--><!--]-->DKMS Concepts<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/developer-guide/infrastructure.html" aria-label="Developer Guide"><!--[--><!--[--><!--]--><!--]-->Developer Guide<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/introduction/why.html" aria-label="DKMS Concepts"><!--[--><!--[--><!--]--><!--]-->DKMS Concepts<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/developer-guide/infrastructure.html" aria-label="Developer Guide"><!--[--><!--[--><!--]--><!--]-->Developer Guide<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">Developer Guide <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/developer-guide/infrastructure.html" aria-label="Infrastructure"><!--[--><!--[--><!--]--><!--]-->Infrastructure<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/developer-guide/client.html" aria-label="Clients"><!--[--><!--[--><!--]--><!--]-->Clients<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="infrastructure" tabindex="-1"><a class="header-anchor" href="#infrastructure"><span>Infrastructure</span></a></h1><p>DKMS infrastructure is composed of two main components: Witnesses and Watchers. Both are available as Docker images:</p><ul><li><a href="https://ghcr.io/thclab/keriox-witness" target="_blank" rel="noopener noreferrer"> Witness </a></li><li><a href="https://ghcr.io/thclab/keriox-watcher" target="_blank" rel="noopener noreferrer"> Watcher </a></li></ul><p>For sample setup, see <a href="https://github.com/THCLab/dkms-demo/blob/main/infrastructure/docker-compose.yml" target="_blank" rel="noopener noreferrer">this</a>. and for more information see <a href="#setup">setup</a> section.</p><h2 id="argo" tabindex="-1"><a class="header-anchor" href="#argo"><span>Argo</span></a></h2><p>Argo is a sandbox which allows you to test right away the DKMS infrastructure without need to setup anything. Checkout our public <a href="https://dashboard.argo.colossi.network/public-dashboards/2bdeda88c701459e8ec25802f79b7da2" target="_blank" rel="noopener noreferrer">dashboard</a> to see the current state of the network.</p><h2 id="setup" tabindex="-1"><a class="header-anchor" href="#setup"><span>Setup</span></a></h2><p>If you would like to run your own DKMS network, follow the instructions below.</p><h3 id="deploy-witnesses" tabindex="-1"><a class="header-anchor" href="#deploy-witnesses"><span>Deploy witnesses</span></a></h3><p>Witnesses play a crucial role in the DKMS infrastructure. They are responsible for disseminating information across the network. In addition witnesses produce reciepts for the controllers as a form of confirmation that he has seen the latest KEL.</p><p>Witness is available as a Docker image. Which can be eailsy deploy, below example using docker compose:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code><span class="line"><span class="token key atrule">services</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">witness</span><span class="token punctuation">:</span> <span class="token important">&amp;witness</span></span>
<span class="line">    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> keriox<span class="token punctuation">-</span>witness</span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&quot;ghcr.io/thclab/keriox-witness:latest&quot;</span></span>
<span class="line">    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</span>
<span class="line">    <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> dkms<span class="token punctuation">-</span>network</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">witness1</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> keriox<span class="token punctuation">-</span>witness1</span>
<span class="line">    <span class="token key atrule">&lt;&lt;</span><span class="token punctuation">:</span> <span class="token important">*witness</span></span>
<span class="line">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;3232:3232&quot;</span></span>
<span class="line">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> bind</span>
<span class="line">        <span class="token key atrule">source</span><span class="token punctuation">:</span> ./config/witness1.yml</span>
<span class="line">        <span class="token key atrule">target</span><span class="token punctuation">:</span> /app/witness.yml</span>
<span class="line">      <span class="token punctuation">-</span> witness1_db_data<span class="token punctuation">:</span>/app/db</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>Never use latest tag for docker image for production systems. Always use specific version. See <a href="https://github.com/THCLab/keriox/releases" target="_blank" rel="noopener noreferrer">Release page</a></p></div><h4 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration"><span>Configuration</span></a></h4><p>To run witness you need to provide a configuration file. Below is an example of it with explanation of each field:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code><span class="line"><span class="token key atrule">db_path</span><span class="token punctuation">:</span> <span class="token string">&quot;db/&quot;</span> <span class="token comment"># path to the database where witness would store KEL&#39;s</span></span>
<span class="line"><span class="token key atrule">http_port</span><span class="token punctuation">:</span> <span class="token number">3232</span> <span class="token comment"># port on which witness will listen for incoming connections</span></span>
<span class="line"><span class="token key atrule">public_url</span><span class="token punctuation">:</span> <span class="token string">&quot;http://172.17.0.1:3232/&quot;</span> <span class="token comment"># public URL of the witness</span></span>
<span class="line"><span class="token key atrule">seed</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;YOUR_SEED_GOES_HERE&quot;</span> <span class="token comment"># seed of the witness to generate private key, keep this secret!</span></span>
<span class="line"><span class="token key atrule">escrow_config</span><span class="token punctuation">:</span> <span class="token comment"># Configuration for the escrow system, which acts as a buffer for processing events from KELs</span></span>
<span class="line">  <span class="token key atrule">default_timeout</span><span class="token punctuation">:</span> <span class="token number">60</span> <span class="token comment"># Time (in seconds) before an event is discarded after the last processing attempt. Event is processed only when new event comes.</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="generate-seed" tabindex="-1"><a class="header-anchor" href="#generate-seed"><span>Generate seed</span></a></h5><p>The seed is necessary to generate the private key for the witness. By definition witness operate with empheral keys means they cannot be rotated. If the key is compromised, the witness should be replaced with a new one. To generate the seed you can use <a href="https://github.com/THCLab/dkms-bin/releases" target="_blank" rel="noopener noreferrer">dkms-cli</a> tool:</p><div id="asciicast-xM1MiAzgCsYAWoeHxhEEm3bt8"></div><p>The seed should be set in the configuration file. Keep it secret!</p><h4 id="run-witness" tabindex="-1"><a class="header-anchor" href="#run-witness"><span>Run witness</span></a></h4><p>Simply run docker contaienrs with <code>docker-compose up -d</code> command.</p><p>After the witness is running you can check the logs with <code>docker logs keriox-witness</code> command. And you should see something like this:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">keriox-witness1  <span class="token operator">|</span> Witness BJq7UABlttINuWJh1Xl2lkqZG4NTdUdqnbFJDa6ZyxCC is listening on port <span class="token number">3232</span></span>
<span class="line">keriox-witness1  <span class="token operator">|</span> Witness&#39;s oobi: <span class="token punctuation">{</span><span class="token string">&quot;eid&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;BJq7UABlttINuWJh1Xl2lkqZG4NTdUdqnbFJDa6ZyxCC&quot;</span>,<span class="token string">&quot;scheme&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;http&quot;</span>,<span class="token string">&quot;url&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;http://localhost:3232/&quot;</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="deploy-watchers" tabindex="-1"><a class="header-anchor" href="#deploy-watchers"><span>Deploy watchers</span></a></h3><p>Watchers are responsible for detecting duplicity in the network. They are also available as a Docker image. Below is an example of how to deploy them:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code><span class="line"><span class="token key atrule">watcher</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">container_name</span><span class="token punctuation">:</span> keriox<span class="token punctuation">-</span>watcher</span>
<span class="line">  <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&quot;ghcr.io/thclab/keriox-watcher:latest&quot;</span></span>
<span class="line">  <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</span>
<span class="line">  <span class="token key atrule">depends_on</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> witness</span>
<span class="line">  <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token string">&quot;3235:3235&quot;</span></span>
<span class="line">  <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> bind</span>
<span class="line">      <span class="token key atrule">source</span><span class="token punctuation">:</span> ./config/watcher.yml</span>
<span class="line">      <span class="token key atrule">target</span><span class="token punctuation">:</span> /app/watcher.yml</span>
<span class="line">    <span class="token punctuation">-</span> watcher_db_data<span class="token punctuation">:</span>/app/db/</span>
<span class="line">  <span class="token key atrule">networks</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> dkms<span class="token punctuation">-</span>network</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="configuration-1" tabindex="-1"><a class="header-anchor" href="#configuration-1"><span>Configuration</span></a></h4><p>To run watcher you need to provide a configuration file. Below is an example of it with explanation of each field:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code><span class="line"><span class="token key atrule">db_path</span><span class="token punctuation">:</span> <span class="token string">&quot;db/&quot;</span> <span class="token comment"># path to the database where watcher would store KEL&#39;s</span></span>
<span class="line"><span class="token key atrule">tel_storage_path</span><span class="token punctuation">:</span> <span class="token string">&quot;db/tel_storage&quot;</span> <span class="token comment"># path to the database where watcher would store TEL&#39;s</span></span>
<span class="line"><span class="token key atrule">public_url</span><span class="token punctuation">:</span> <span class="token string">&quot;http://172.17.0.1:3235&quot;</span> <span class="token comment"># public url of the watcher</span></span>
<span class="line"><span class="token key atrule">seed</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;HERE_GOES_SEEF_OF_THE_WATCHER&quot;</span> <span class="token comment"># seed of the watcher to generate private key, keep this secret!</span></span>
<span class="line"><span class="token key atrule">http_port</span><span class="token punctuation">:</span> <span class="token number">3235</span> <span class="token comment"># port on which watcher will listen for incoming connections</span></span>
<span class="line"><span class="token key atrule">escrow_config</span><span class="token punctuation">:</span> <span class="token comment"># Configuration for the escrow system, which acts as a buffer for processing events from KELs</span></span>
<span class="line">  <span class="token key atrule">default_timeout</span><span class="token punctuation">:</span> <span class="token number">60</span> <span class="token comment"># Time (in seconds) before an event is discarded after the last processing attempt. Event is processed only when new event comes.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="generate-seed-1" tabindex="-1"><a class="header-anchor" href="#generate-seed-1"><span>Generate seed</span></a></h4><p>To generate seed see the <a href="#generate-seed">Generate seed</a> section in the witness configuration.</p><h4 id="run-watcher" tabindex="-1"><a class="header-anchor" href="#run-watcher"><span>Run watcher</span></a></h4><p>Simply run docker contaienrs with <code>docker-compose up -d</code> command.</p><p>After the watcher is running you can check the logs with <code>docker logs keriox-watcher</code> command. And you should see something like this:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">keriox-watcher  <span class="token operator">|</span> Using config file: <span class="token string">&quot;./watcher.yml&quot;</span></span>
<span class="line">keriox-watcher  <span class="token operator">|</span> Using environment prefix: <span class="token string">&quot;WATCHER_&quot;</span></span>
<span class="line">keriox-watcher  <span class="token operator">|</span> Watcher BF2t2NPc1bwptY1hYV0YCib1JjQ11k9jtuaZemecPF5b is listening on port <span class="token number">3236</span></span>
<span class="line">keriox-watcher  <span class="token operator">|</span> Watcher&#39;s oobi: <span class="token punctuation">{</span><span class="token string">&quot;eid&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;BF2t2NPc1bwptY1hYV0YCib1JjQ11k9jtuaZemecPF5b&quot;</span>,<span class="token string">&quot;scheme&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;http&quot;</span>,<span class="token string">&quot;url&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;http://localhost:3236/&quot;</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="next-steps" tabindex="-1"><a class="header-anchor" href="#next-steps"><span>Next Steps</span></a></h2><p>After you have deployed witnesses and watchers, you can start using the <a href="https://github.com/THCLab/dkms-bin/releases" target="_blank" rel="noopener noreferrer">DKMS-CLI</a> to start interacting with them. See the <a href="/developer-guide/client">CLI documentation</a> for more information.</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated:: </span><time class="meta-item-info" datetime="2025-03-28T10:31:52.000Z" data-allow-mismatch>3/28/25, 10:31 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: blelump@martex.nom.pl">blelump</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: robert.mitwicki@humancolossus.org">Robert Mitwicki</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><!----><a class="route-link auto-link next" href="/developer-guide/client.html" aria-label="Clients"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">Clients</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-1xjWvnao.js" defer></script>
  </body>
</html>
